# This is the default qrexec policy. DO NOT EDIT THIS FILE, it will be
# overwritten on the next update. Edit '30-user' instead.

qubes.Filecopy          *   @anyvm                  @anyvm      ask

qubes.FeaturesRequest   *   @anyvm                  @adminvm    allow
qubes.NotifyTools       *   @anyvm                  @adminvm    allow
qubes.NotifyUpdates     *   @anyvm                  @adminvm    allow
qubes.ReceiveUpdates    *   @anyvm                  @adminvm    allow
qubes.SyncAppMenus      *   @anyvm                  @adminvm    allow
qubes.WindowIconUpdater *   @anyvm                  @adminvm    allow

qubes.UpdatesProxy      *   @tag:whonix-updatevm    @default    allow   target=sys-whonix
qubes.UpdatesProxy      *   @tag:whonix-updatevm    @anyvm      deny
qubes.UpdatesProxy      *   @type:TemplateVM        @default    allow   target=sys-net
qubes.UpdatesProxy      *   @anyvm                  @anyvm      deny

qubes.GetDate           *   @tag:anon-vm            @anyvm      deny
qubes.GetDate           *   @anyvm                  @anyvm      allow   target=@adminvm
qubes.GetRandomizedTime *   @anyvm                  @adminvm    allow

qubes.GetImageRGBA      *   @anyvm                  @dispvm     allow
qubes.GetImageRGBA      *   @anyvm                  @anyvm      ask
qubes.PdfConvert        *   @anyvm                  @dispvm     allow

qubes.Gpg               *   @anyvm                  @anyvm      ask
qubes.GpgImportKey      *   @anyvm                  @anyvm      ask

qubes.InputKeyboard     *   @anyvm                  @anyvm      deny
qubes.InputMouse        *   @anyvm                  @anyvm      deny
qubes.InputTablet       *   @anyvm                  @anyvm      deny

qubes.OpenInVM          *   @anyvm                  @dispvm     allow
qubes.OpenInVM          *   @anyvm                  @anyvm      ask
qubes.OpenURL           *   @anyvm                  @dispvm     allow
qubes.OpenURL           *   @anyvm                  @anyvm      ask
qubes.StartApp          *   @anyvm                  @dispvm     allow
qubes.StartApp          *   @anyvm                  @anyvm      ask

qubes.USB               *   @anyvm                  @anyvm      deny

# NOTE: add user=root to any ask or allow rules!
qubes.VMRootShell       *   @anyvm                  @anyvm      deny

qubes.VMShell           *   @anyvm                  @dispvm     allow
qubes.VMShell           *   @anyvm                  @anyvm      deny

policy.RegisterArgument *   @anyvm                  @anyvm      deny
